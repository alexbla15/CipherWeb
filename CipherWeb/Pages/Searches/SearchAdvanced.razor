@page "/Search/Advanced"

<PageTitle>חיפוש מתקדם</PageTitle>

<CipherComponentCard Title="נא לבחור אובייקטים לתצוגה" ContentJustify="center" ContentDisplay="flex">
    <RadzenSelectBar @bind-Value="@objectId" Multiple="false" TValue="int">
        <Items>
            @foreach (string objType in objectTypes)
            {
                <RadzenSelectBarItem Text="@objType" Value="@objectTypes.IndexOf(objType)" />
            }
        </Items>
    </RadzenSelectBar>
</CipherComponentCard>
@RenderCipherDataFilter(objectId)

@code {
    [Parameter]
    public int objectId { get; set; }

    [Parameter]
    public List<string> objectTypes { get; set; } =
    new List<string> { "תעודות", "כלים", "מערכות", "תחומים", "מבנים", "תנועות", "תהליכים", "קווים", "סוגים" };


    string width = "width: 200px";

    private ErrorResponse error = ErrorResponse.Success;

    private List<Package> packs = new List<Package>();
    private List<Vessel> vessels = new List<Vessel>();
    private List<StorageSystem> systems = new List<StorageSystem>();
    private List<Event> events = new List<Event>();
    private List<Process> procs = new List<Process>();
    private List<Category> categories = new List<Category>();

    protected override void OnInitialized()
    {
        (packs, error) = Package.All();
        (vessels, error) = Vessel.All();
        (systems, error) = StorageSystem.All();
        (events, error) = Event.All();
        (procs, error) = Process.All();
        (categories, error) = Category.All();
    }

    private RenderFragment RenderCipherDataFilter(int objectId) => objectId switch
    {
        0 => @<CipherDataFilter_WithDataGrid Cipher_TItem="Package" Title="סינון נתונים" GeneralDataSource="@packs" />,
        1 => @<CipherDataFilter_WithDataGrid Cipher_TItem="Vessel" Title="סינון נתונים" GeneralDataSource="@vessels" />,
        2 or 3 or 4 => @<CipherDataFilter_WithDataGrid Cipher_TItem="StorageSystem" Title="סינון נתונים" GeneralDataSource="@systems" />,
        5 => @<CipherDataFilter_WithDataGrid Cipher_TItem="Event" Title="סינון נתונים" GeneralDataSource="@events" />,
        6 or 7 => @<CipherDataFilter_WithDataGrid Cipher_TItem="Process" Title="סינון נתונים" GeneralDataSource="@procs" />,
        8 => @<CipherDataFilter_WithDataGrid Cipher_TItem="Category" Title="סינון נתונים" GeneralDataSource="@categories" />,
        _ => null
    };
}
