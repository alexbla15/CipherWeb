@inherits CipherFormRow

@inject ICipherInfo _db

<CipherFormRow Icon="@Icon">
    <RadzenDropDownDataGrid Placeholder="@Label" SearchTextPlaceholder="חיפוש..." TValue="string" Disabled="@Disabled"
                            Data=@subCategories TextProperty="@(nameof(cat.Name))" 
                            ValueProperty="@(nameof(cat.Name))"
                            AllowColumnResize="true" AllowFilteringByAllStringColumns="true" Style="@($"width: {Width}")">
        <Columns>
            <RadzenDropDownDataGridColumn Property="@(nameof(cat.Id))" Title="@(cat.Translate(nameof(cat.Id)))" />
            <RadzenDropDownDataGridColumn Property="@(nameof(cat.Name))" Title="@(cat.Translate(nameof(cat.Name)))" />
            <RadzenDropDownDataGridColumn Property="@(nameof(cat.MaterialType))" Title="@(cat.Translate(nameof(cat.MaterialType)))" />
            <RadzenDropDownDataGridColumn Property="@(nameof(cat.IdMask))" Title="@(cat.Translate(nameof(cat.IdMask)))">
                <Template>
                    @(string.Join(", ", (context as Category).IdMask))
                </Template>
            </RadzenDropDownDataGridColumn>
        </Columns>
        <ValueTemplate>
            <b>@Label:</b> @((context as Category).Name)
        </ValueTemplate>
    </RadzenDropDownDataGrid>
</CipherFormRow>

@code {
    /// <summary>
    /// Is the drop down disabled.
    /// </summary>
    [Parameter]
    public bool Disabled { get; set; } = false;

    private List<Category> subCategories = new List<Category>();
    private ErrorResponse error = ErrorResponse.Success;
    private Category cat = Category.Random();

    protected override void OnInitialized()
    {
        Label ??= "קטגוריה";
        Icon ??= Icons.Symbols.Category;
        Width ??= "300px";

        (subCategories, error) = Category.All();
    }
}