@using Radzen
@using CipherData
@using CipherData.Models
@using CipherWeb.Shared.Components
@using CipherWeb.Shared.Components.Buttons

@inject ICipherInfo _db

@inherits CipherTableCard

<CipherTableCard Title="@Title" DataSource="@events" Variant="@Variant" WithCard="@WithCard" WithButtons="@WithButtons">
    <ComponentContent>
        <CipherDataGrid Cipher_TItem="Event" DataSource="@events"
                        GridFilterMode="@FilterMode" AllowFilter="@AllowFilter" AllowGroup="@AllowGroup" />
    </ComponentContent>
</CipherTableCard>

@code {
    [Parameter]
    public FilterMode FilterMode { get; set; } = FilterMode.SimpleWithMenu;

    [Parameter]
    public bool AllowFilter { get; set; } = true;

    [Parameter]
    public bool AllowGroup { get; set; } = true;

    List<Event> events = new List<Event>();

    protected override async Task OnInitializedAsync()
    {
        events = await _db.GetEvents();

        Title = (Title is null) ? "דוח תנועות" : Title;
    }
}