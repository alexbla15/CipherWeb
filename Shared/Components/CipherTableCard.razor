@using Radzen
@using CipherData.Models
@using CipherWeb.Data
@using CipherWeb.Shared.Components
@using CipherWeb.Shared.Components.Buttons

@inherits CipherComponentCard

<CipherComponentCard MaxWidth="@MaxWidth" Width="@Width" Title="@Title" WithCard="@WithCard" WithButtons="@WithButtons" Height="@Height">
    <Buttons>
        @if(ExcelExport)
        {
            <CipherExcelButton FileName="@FileTitle" Data="@DataSource" />
        }
        @if (PDFExport)
        {
            <CipherPDFButton />
        }
        @if (ExpandPath != null)
        {
            <CipherNavButton Icon="@Icons.Expand" Variant="Variant.Outlined" HelpText="הרחבה" Path="@ExpandPath" />
        }
    </Buttons>
    <ChildContent>
        @ComponentContent
    </ChildContent>
</CipherComponentCard>

@code {
    [Parameter]
    public RenderFragment ComponentContent { get; set; }

    [Parameter]
    public IEnumerable<object> DataSource { get; set; }

    [Parameter]
    public string FileTitle { get; set; }

    [Parameter]
    public bool ExcelExport { get; set; } = true;

    [Parameter]
    public bool PDFExport { get; set; } = true;

    [Parameter]
    public string? ExpandPath { get; set; } = null;
}